%!
(dmmlib/base.ps) run
(dmmlib/lines.ps) run

/drawmaze { /grid arg
    0.1 setlinewidth
    1 setlinecap 1 setlinejoin
    0 0 grid /width get grid /height get box stroke
    0.5 0.5 translate
    grid /field known {
        /field grid /field get def
        /step field length 1 sub recip def
        0 1 field length 1 sub { /i arg
            gsave
                i step mul 1 exch sub dup 1 setrgbcolor
                field i get {
                    gsave
                        aload pop translate
                        -0.5 -0.5 0.5 0.5 box fill
                    grestore
                } forall
            grestore
        } for
    } if
    grid /cells get {
        gsave
            aload pop /walls arg /position arg
            position aload pop translate
            0 1 3 { /i arg
                walls i get {
                    gsave
                        i 0 sub 90 mul rotate
                        0.5 -0.5 goto
                        0.5 0.5 goto
                        stroke
                    grestore
                } if
            } for
        grestore
    } forall
    grid /path known {
        grid /path get {
            aload pop goto
        } forall
        1 0 0 setrgbcolor
        stroke
    } if
} def
%%EndProlog
